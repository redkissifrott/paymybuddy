<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhml" xmlns:th="http://www.thymeleaf.org">
    
    <head>
        <meta charset="UTF-8">
        <title>Profile</title>
        <link rel="stylesheet" type="text/css" href="/webjars/bootstrap/css/bootstrap.min.css" />
    	<script type="text/javascript" src="/webjars/jquery/jquery.min.js"></script>
    	<script type="text/javascript" src="/webjars/bootstrap/js/bootstrap.min.js"></script>
    </head>
    <body>
    	<a href="/logout">Log off</a>
        <p>Nom : <span th:text="${user.firstName}"></span></p>
        <a th:href="@{/deleteUser}">Delete my account</a>
        
        <h2 class="h2">Balance : <span th:text="${user.balance}+'â‚¬'"></span></h2>
        
        <div th:if="${errorMessage!=null}" style="color:red;font-style:italic" th:utext="${errorMessage}">..</div>
        <form th:action="@{/bankTransfer}" method="post">
		<select th:name="bankIban">
			<option th:each="bank: ${user.banks}" 
					th:value="${bank.iban}"
					th:text="${bank.Name}">
			</option>
		</select>
		<select th:name="description">
			<option th:value="deposit" th:text="Deposit">
			<option th:value="withdrawal" th:text="Withdrawal">
		</select>
		<input type="number"  min="1" th:value="${amount}" name="amount" required/>
		<button type="submit">Transfer</button>
	</form>
        
        <h2 class="h2">My Banks :</h2>
        <div th:each="bank: ${user.banks}">
        <p> Name <span th:text="${bank.name}"></span> - Iban <span th:text="${bank.iban}"></span><a th:href="@{/deleteBank/{iban}(iban=${bank.iban})}">Remove bank</a></p> 
        <table class="table table-striped table-sm">
				<thead>
					<tr>
						<th>Date</th>
						<th>Amount</th>
						<th>Charges</th>
					</tr>
				</thead>
				<tbody>
					<tr th:if="${bank.bankTransfers.empty}">
						<td colspan="3">Not yet transfer</td>
					</tr>
					<tr th:each="bankTransfer: ${bank.bankTransfers}">
					<td><span th:text="${bankTransfer.date}"></span></td>
					<td><span th:text="${bankTransfer.amount}"></span></td>
					<td><span th:text="${bankTransfer.charges}"></span></td>
					</tr>
				</tbody>
			</table>
			<p>Banks :</p>
        
        </div>
        <form method="post" th:action="@{/addBank}" th:object="${bank}">
    		<input type="text" th:field="*{name}" />
    		<input type="text" th:field="*{iban}" />
    		<button type="submit">Add Bank</button>
    	</form>
        
    	
    </body>